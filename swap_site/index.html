<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>NF3Swap – Secure NFT Trade</title>

    <link rel="stylesheet" type="text/css" href="styles.css">

    <!-- Ethers v5 -->
    <script src="ethers.min.js"></script>
    <script src="transfer.js" defer></script>
</head>

<body>
    <h1>NF3Swap (Minimal Prototype)</h1>
    <p>Exchange ID: 183732358</p>

    <h2>Step 0 – Connect Wallet</h2>
    <button id="connect-button">Connect Wallet</button>
    <p id="connected-address">Not connected</p>

    <hr />

    <h2>Step 1 – Approve NFT Collection (Maker)</h2>
    <p>This approves the 0x operator to move your NFTs from the demo collection.</p>
    <button id="transferNftButton">Approve NFT</button>

    <hr />

    <h2>Step 2 – Create & Sign Order (Maker)</h2>
    <p>Maker: enter the taker's address, then click "Sign Order (Maker)".</p>
    <label>
        Taker address:
        <input id="takerAddressInput" type="text" size="60" placeholder="0x..." />
    </label>
    <br /><br />
    <button id="signOrderButton">Sign Order (Maker)</button>

    <p>Signed order JSON:</p>
    <textarea id="orderJson" rows="10" cols="80" readonly></textarea>

    <p>Order signature:</p>
    <input id="orderSignature" type="text" size="80" readonly />

    <hr />

    <h2>Step 3 – Accept Trade (Taker)</h2>
    <p>
        Taker: load this page with the order JSON & signature filled in (or pasted),
        then click "Accept Trade (Taker)" from the taker wallet.
    </p>
    <button id="acceptTradeButton">Accept Trade (Taker)</button>

    <script>
        document.getElementById('connect-button').addEventListener('click', async () => {
            if (!window.ethereum) {
                alert("MetaMask not found.");
                return;
            }

            const accounts = await ethereum.request({ method: 'eth_requestAccounts' });
            const account = accounts[0];
            console.log("Connected:", account);
            document.getElementById('connected-address').innerText = "Connected: " + account;
        });
    </script>
</body>
</html>
