<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>NF3Swap – Secure NFT Trade</title>

    <link rel="stylesheet" type="text/css" href="styles.css">

    <!-- Ethers v5 -->
    <script src="ethers.min.js"></script>
    <script src="transfer.js" defer></script>
</head>

<body>
    <h1>NF3Swap (Minimal Prototype)</h1>
    <p>Exchange ID: 183732358</p>

    <h2>Step 0 – Connect Wallet</h2>
    <button id="connect-button">Connect Wallet</button>
    <p id="connected-address">Not connected</p>

    <hr />

    <h2>Step 1 – Maker NFT & Approval</h2>
    <p>Maker: choose the NFT you are offering, then approve the 0x operator.</p>

    <h3>Maker NFT (what YOU send)</h3>

    <label>
        Maker NFT contract:
        <input
            id="makerNftContractInput"
            type="text"
            size="60"
            placeholder="0x... NFT contract address"
        />
    </label>
    <br /><br />

    <label>
        Maker NFT token ID:
        <input
            id="makerTokenIdInput"
            type="text"
            size="20"
            placeholder="e.g. 12923"
        />
    </label>
    <br /><br />

    <button id="transferNftButton">Approve Maker NFT</button>

    <hr />

    <h2>Step 2 – Create & Sign Order (Maker)</h2>
    <p>Maker: enter the taker’s wallet and the NFT the TAKER will send.</p>

    <label>
        Taker address:
        <input id="takerAddressInput" type="text" size="60" placeholder="0x..." />
    </label>

    <h3>Taker NFT (what the TAKER sends)</h3>

    <label>
        Taker NFT contract:
        <input
            id="takerNftContractInput"
            type="text"
            size="60"
            placeholder="0x... NFT contract address"
        />
    </label>
    <br /><br />

    <label>
        Taker NFT token ID:
        <input
            id="takerTokenIdInput"
            type="text"
            size="20"
            placeholder="e.g. 1234"
        />
    </label>

    <br /><br />
    <button id="signOrderButton">Sign Order (Maker)</button>

    <h3>Signed order JSON:</h3>
    <textarea id="orderJson" rows="10" cols="80" readonly></textarea>

    <h3>Order signature:</h3>
    <input id="orderSignature" type="text" size="80" readonly />

    <hr />

    <h2>Step 3 – Accept Trade (Taker)</h2>
    <p>
        Taker: open the trade link or paste the order + signature, then click accept
        from the wallet that owns the taker NFT.
    </p>
    <button id="acceptTradeButton">Accept Trade (Taker)</button>

    <script>
        document.getElementById('connect-button').addEventListener('click', async () => {
            if (!window.ethereum) {
                alert("MetaMask not found.");
                return;
            }

            const accounts = await ethereum.request({ method: 'eth_requestAccounts' });
            const account = accounts[0];
            console.log("Connected:", account);
            document.getElementById('connected-address').innerText = "Connected: " + account;
        });
    </script>

</body>
</html>
